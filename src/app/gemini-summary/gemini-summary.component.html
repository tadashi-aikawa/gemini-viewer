<md-sidenav-container>

    <md-sidenav #sidenav mode="side" class="app-sidenav" align="start">
        <div *ngIf="searchingSummary">
            <md-spinner></md-spinner>
        </div>
        <div *ngIf="searchErrorMessage">
            <md-chip-list>
                <md-chip color="warn" selected="true" [mdTooltip]="searchErrorMessage" mdTooltipPosition="after">
                    Error!!
                </md-chip>
            </md-chip-list>
        </div>
        <div *ngIf="!searchingSummary && !searchErrorMessage">
            <md-card *ngFor="let row of rows"
                     (click)="showReport(row.hashkey)"
                     [ngClass]="activeReport && row.hashkey == activeReport.key ?
                        ['hvr-curl-bottom-right', 'summary-card', 'summary-card-active'] :
                            ['hvr-curl-bottom-right', 'summary-card']"
            >
                <md-card-header>
                    <md-card-title>{{row.title}}</md-card-title>
                    <md-icon (click)="removeDetail(row.hashkey, $event)"
                             class="action-icon hvr-buzz-out">
                        delete_forever
                    </md-icon>
                    <md-card-subtitle>{{row.begin_time}}</md-card-subtitle>
                </md-card-header>
                <md-card-content>
                    <md-chip-list class="mat-chip-list-stacked">
                        <md-chip color="primary" selected="true">{{row.same_count}}</md-chip>
                        <md-chip color="accent" selected="true">{{row.different_count}}</md-chip>
                        <md-chip color="warn" selected="true">{{row.failure_count}}</md-chip>
                    </md-chip-list>
                    <span *ngIf="loadingReportKey == row.hashkey">
                        Now Loading...
                        <md-progress-bar mode="indeterminate"></md-progress-bar>
                    </span>
                    <span *ngIf="row.deleting">
                        Now Deleting...
                        <md-progress-bar mode="indeterminate" color="warn"></md-progress-bar>
                    </span>
                    <span *ngIf="row.deleteErrorMessage">
                        <md-chip-list class="smart-padding-without-bottom">
                            <md-chip color="warn" selected="true" [mdTooltip]="row.deleteErrorMessage" mdTooltipPosition="after">
                                Fail to delete!!
                            </md-chip>
                        </md-chip-list>
                    </span>
                </md-card-content>
            </md-card>
        </div>
    </md-sidenav>

    <div class="smart-padding">

        <md-input-container>
            <input mdInput #keyWord (keyup.enter)="searchReport(keyWord.value); sidenav.open()">
            <md-placeholder>
                <i class="material-icons app-input-icon">search</i> Search word
            </md-placeholder>
        </md-input-container>
        <hr/>
        <div *ngIf="activeReport">
            <div style="float: right;">
                <md-icon>access_time</md-icon>
                <small>{{activeReport.summary.time.start}} ï½ž {{activeReport.summary.time.end}}</small>
            </div>
            <h2>{{activeReport.title}}</h2>
            <div class="smart-padding-without-top">
                <small><md-chip>Left</md-chip> {{activeReport.summary.one.host}}</small>
                <small><md-chip>Right</md-chip> {{activeReport.summary.other.host}}</small>
            </div>
            <ng2-smart-table [settings]="settings"
                             [source]="tableSource"
                             (userRowSelect)="onSelectRow($event.data);"
            >
            </ng2-smart-table>
        </div>
        <p class="error" *ngIf="errorMessage">{{errorMessage}}</p>
    </div>

</md-sidenav-container>
